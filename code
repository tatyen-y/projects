# Разделяем DataFrame на две части: с непустыми и с пустыми датами
df_non_empty_dates = df.dropna(subset=['end_date'])
df_empty_dates = df[df['end_date'].isna()]

# Обрабатываем непустые даты
df_non_empty_max_dates = df_non_empty_dates.groupby('objectId', as_index=False).max()

# Обрабатываем пустые даты, выбираем первую запись для каждого objectId
df_empty_dates_first = df_empty_dates.groupby('objectId', as_index=False).first()

# Объединяем результаты, давая приоритет непустым датам
combined_df = pd.concat([df_non_empty_max_dates, df_empty_dates_first]).drop_duplicates('objectId', keep='first')

combined_df


