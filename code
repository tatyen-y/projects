from functions.df_functions import Analogs
from tqdm import tqdm

# создаем объект класса
processor = Analogs()

# скидываем индексы, чтобы убрать возможные дубли и упорядочить
df = df.reset_index(drop=True)
df['ID'] = df.index

# создаем списки для значений будущих столбцов
regional_price = []
regional_readiness = []

# проходим по датасету, ищем региональные цены и генерим значения
for idx in tqdm(df.index):
    target_row = df.iloc[[idx]]  # Получаем строку данных для текущего индекса
    price_mean, readiness_mean = processor.get_regional_price(target_row, df)
    regional_price.append(price_mean)
    regional_readiness.append(readiness_mean)

# Добавляем результаты в DataFrame
df['regional_price'] = regional_price
df['regional_readiness'] = regional_readiness

# Сохраняем обновленный DataFrame
df.to_excel('updated_dataset_with_regional_prices.xlsx', index=False)

print("Процесс завершен!")
